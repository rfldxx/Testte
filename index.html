<!DOCTYPE html>
<html>
<head>
    <title>WASM Demo</title>
</head>
<body>
    <h2>WASM Function Demo: f(x) = x * 3</h2>
    
    <input type="number" id="input" value="7" style="padding: 8px; font-size: 16px;">
    <button onclick="calc()" style="padding: 8px 16px; font-size: 16px;">Calculate</button>
    
    <div id="result" style="margin-top: 20px; font-size: 18px; font-weight: bold;"></div>

    <script>
        // Простой загрузчик WASM
        async function init() {
            // 1. Загружаем WASM файл
            const response = await fetch('main.wasm');
            const bytes = await response.arrayBuffer();
            
            // 2. Компилируем и создаём экземпляр
            const { instance } = await WebAssembly.instantiate(bytes);
            
            // 3. Сохраняем экспортированные функции
            window.wasmExports = instance.exports;
            
            console.log('WASM loaded!');
        }
        
        // Функция для вычисления
        function calc() {
            if (!window.wasmExports) {
                alert('WASM not loaded yet!');
                return;
            }
            
            const input = document.getElementById('input');
            const value = parseInt(input.value) || 0;
            
            // Вызываем WASM функцию
            const result = window.wasmExports.f(value);
            
            // Показываем результат
            document.getElementById('result').textContent = 
                `f(${value}) = ${value} * 3 = ${result}`;
        }
        
        // Загружаем WASM при загрузке страницы
        init().catch(error => {
            console.error('Failed to load WASM:', error);
            document.getElementById('result').textContent = 'Error loading WASM';
        });
    </script>
</body>
</html>
